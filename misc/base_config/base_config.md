**Базовая настройка коммутатора/маршрутизатора**

```

enable
configure terminal

! При наборе неверных команд, не пытаться их интерпретировать
! как имя хоста с последующим походом в DNS
no ip domain-lookup

```

***Имя хоста и баннер***

Пользователь сначала увидит banner motd, а затем, когда будет готов ввести свои учетные данные, увидит banner login

```

hostname Switch-2960C
banner motd = 
        .__       .__           ____ 
  _____ |__| _____|  |__   ____/_   |
 /     \|  |/  ___/  |  \_/ __ \|   |
|  Y Y  \  |\___ \|   Y  \  ___/|   |
|__|_|  /__/____  >___|  /\___  >___|
      \/        \/     \/     \/     
=

! banner login в CPT не работает, но работает на "железном" Cisco Catalist 2960C
banner login % Hello, Switch %

```

***Настройка паролей***

Команда `line console 0` с подкомандами `password` и `login` включают аутентификацию на входе в систему и устанавливают пароль на консольном терминальном порту;
`logging synchronous` - изменяет поведение отображения системных сообщений на устройствах Cisco так, чтобы они не прерывали текущий ввод команд в CLI

```

! Пароль на CONSOLE
line console 0
logging synchronous
password cisco
login
exit

```

Скрываем пароли (т.к. у `line con` и `line vty` (см. ниже) нет подкоманды `secret`, только `password`)

```

! Включение службы шифрования паролей в текущей конфигурации
service password-encryption

! Отключение службы шифрования паролей
! no service password-encryption

```

Пароль на доступ к привилегированному режиму EXEC

```

! Пароль на enable
! enable password class
! или
enable secret class

```

***Настройка SVI для управления коммутатором (управляющий VLAN) - только для коммутатора***

SVI (Switched Virtual Interface) — это виртуальный интерфейс на коммутаторе, который связывается с конкретным VLAN. SVI используется для предоставления IP-сервисов для VLAN и позволяет выполнять маршрутизацию между различными VLAN на уровне коммутатора.

note: Назначение ip-адреса - это только для коммутатора, у маршрутизатора ip-адрес и так есть (настраивается на интерфейсе)

```

! Лучше сделать отдельный управляющий VLAN
!S1# configure terminal
!S1(config)# vlan 10
!S1(config-vlan)# name ManagementVLAN
!S1(config-vlan)# exit

! SVI для управления коммутатором (управляющий VLAN)
interface vlan 1
ip address 192.168.1.11 255.255.255.0
no shutdown
exit

```

Если подключаться к коммутатору планируется не только из внутренней сети, то нужно настроить шлюз по умолчанию:

```

ip default-gateway 192.168.1.1

! для ipv6 настройка шлюза выглядит так:
!ipv6 route ::/0 2001:c0de:cafe::1

```

***Настройка доступа через Telnet (для удаленного управления)***

Порты Telnet на коммутаторе/маршрутизаторе известны как линии VTY (Virtual TeletYpe). На коммутаторе может работать до 16 виртуальных портов, обеспечивающих до 16 одновременных сеансов Telnet. Виртуальные порты пронумерованы от 0 до 15.

Команда `line vty 0 4` с подкомандами `password` и `login` включают аутентификацию на входе в систему и устанавливают пароль для сеансов Telnet

```

! Пароль на VTY
line vty 0 4
logging synchronous
password cisco
login

! ... и (явно) разрешить подключение по telnet (в Cisco Telnet обычно включен по дефолту)
transport input telnet

exit

```

Теперь коммутатор доступен по ip-адресу 192.168.1.11 через Telnet. На удалённой машине можно использовать клиент Telnet: `telnet 192.168.1.11`

***Настройка доступа через SSH (для удаленного управления)***

Протокол SSH - безопасная замена Telnet, которая обеспечивает аналогичный тип доступа.

1. Для генерации криптографического ключа SSH, чтобы в конфигурации были заданы и имя хоста и имя домена

```

! Имя хоста уже задано выше командой
! hostname Switch-2960C

! Имя домена
ip domain-name example.com

```

2. Сгенерировать пару ключей RSA

```

! На запрос размера ключа, ввести 2048
crypto key generate rsa

! Включить вторую версию SSH (проверить можно командой show ip ssh)
ip ssh version 2

```

3. Протокол SSH также требует учетную запись пользователя в локальной базе данных (аутентификация на основе просто пароля не поддерживается в ssh)

```

! Создаем пару имя_пользователя/пароль (admin/god),
! которая может использоваться как локальная база данных для аутентификации
username admin password god

```

4. Включаем SSH на VTY

```

line vty 0 4
! Переводит процесс входа на использование локально заданных пар пользователь/пароль
login local

! ... и разрешить подключение по ssh
transport input ssh

! эта команда разрешает и telnet и ssh для vty
! (но, похоже, не все девайсы поддерживают оба варианта одновременно)
! transport input telnet ssh

```

На удалённой машине можно использовать клиент SSH: `ssh -l admin  192.168.1.11`

***Настройки ipv6 на коммутаторе - только для коммутатора***

Шаблон по умолчанию менеджера базы данных Switch Database Manager (SDM) не поддерживает IPv6. Для включения ipv6-адресации нужно сменить шаблон. Новый шаблон начнет работать после перезагрузки

```

sdm prefer dual-ipv4-and-ipv6 default
reload

```

Шлюз по умолчанию:

```

ipv6 route ::/0 2001:dead:beaf::1

```

***Настройки ipv6 на маршрутизаторе - только для маршрутизатора***

Включение ipv6-маршрутизации на роутере:

```

ipv6 unicast-routing

```

***Копируем текущую конфигурацию в NVRAM***

```

! Сохраняем конфигурацию
! write memory
copy running-config startup-config

```